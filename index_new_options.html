<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Loan Prepayment Calculator V2.0</title>
    <meta name="title" content="Home Loan Prepayment Calculator">
    <meta name="description" content="Calculate your home loan prepayment savings and payoff timeline using this simple, interactive tool. Get a detailed breakdown of monthly payments and savings.">
    <meta name="keywords" content="Home loan calculator, Loan prepayment, Loan payoff calculator, EMI calculator, Mortgage calculator, Loan interest savings, Extra payment calculator, Loan term reduction, Home loan interest rate, Mortgage prepayment, Loan amortization, Early loan repayment, Financial planning, Monthly payment calculator">
    <meta name="robots" content="index, follow">
    <meta name="author" content="ANOOP P">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .calculator-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .header p {
            color: #6b7280;
            font-size: 1.1rem;
        }

        .loan-details-section {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 32px;
            border: 1px solid #e2e8f0;
        }

        .loan-details-section h3 {
            color: #1e293b;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .payment-options-section {
            margin-bottom: 32px;
        }

        .payment-option {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            position: relative;
        }

        .payment-option.active {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .payment-option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .payment-option-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .payment-option-title h4 {
            color: #1e293b;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .option-toggle {
            position: relative;
            width: 50px;
            height: 26px;
            background: #e5e7eb;
            border-radius: 13px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .option-toggle.active {
            background: #667eea;
        }

        .option-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .option-toggle.active::after {
            transform: translateX(24px);
        }

        .payment-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .remove-option-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .remove-option-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .add-option-btn {
            width: 100%;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 24px;
        }

        .add-option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }

        .input-group {
            position: relative;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .input-group input {
            width: 100%;
            padding: 12px 14px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .calculate-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 24px 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .results-section {
            display: none;
            margin: 32px 0;
        }

        .comparison-container {
            display: grid;
            gap: 24px;
            margin-bottom: 32px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .result-card {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 24px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            position: relative;
        }

        .result-card.best-option {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }

        .best-badge {
            position: absolute;
            top: -8px;
            right: 16px;
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .result-card h4 {
            color: #1e293b;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 16px;
            text-align: center;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            color: #64748b;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .result-value {
            font-weight: 700;
            font-size: 1rem;
        }

        .emi-value {
            color: #dc2626;
        }

        .savings-value {
            color: #059669;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 32px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .table-container {
            margin-top: 32px;
            overflow-x: auto;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 800px;
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }

        tbody tr:nth-child(even) {
            background-color: #f8fafc;
        }

        tbody tr:hover {
            background-color: #e0f2fe;
            transform: scale(1.01);
            transition: all 0.2s ease;
        }

        .currency {
            font-weight: 600;
            color: #1e293b;
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .payment-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .calculator-container {
                padding: 24px;
                border-radius: 16px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .payment-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .payment-option {
                padding: 16px;
            }

            .input-group input {
                padding: 10px;
            }

            .calculate-btn {
                padding: 14px 24px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <div class="header">
            <h1>Home Loan Prepayment Calculator V2.0</h1>
            <p>Calculate and compare multiple payment strategies</p>
        </div>

        <!-- Loan Details Section -->
        <div class="loan-details-section">
            <h3>ðŸ“Š Loan Details</h3>
            <div class="form-grid">
                <div class="input-group">
                    <label for="loan-amount">Loan Amount (â‚¹)</label>
                    <input type="number" id="loan-amount" required value="1960830" min="0" step="1000">
                </div>
                
                <div class="input-group">
                    <label for="interest-rate">Interest Rate (%)</label>
                    <input type="number" id="interest-rate" step="0.01" required value="7.7" min="0" max="20">
                </div>
                
                <div class="input-group">
                    <label for="start-date">Start Date</label>
                    <input type="date" id="start-date" required>
                </div>
                
                <div class="input-group">
                    <label for="loan-term">Loan Term (months)</label>
                    <input type="number" id="loan-term" required value="189" min="1" max="600">
                </div>
            </div>
        </div>

        <!-- Payment Options Section -->
        <div class="payment-options-section">
            <div id="payment-options-container">
                <!-- Payment options will be dynamically added here -->
            </div>
            
            <button class="add-option-btn" onclick="addPaymentOption()">
                âž• Add Payment Option
            </button>
        </div>

        <button class="calculate-btn" onclick="calculate()">
            Calculate & Compare Options
        </button>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Calculating your loan payoff scenarios...</p>
        </div>

        <div class="results-section" id="results-section">
            <div class="comparison-container" id="comparison-container">
                <!-- Comparison results will be populated here -->
            </div>
            
            <div class="table-container" id="table-container">
                <table id="resultTable">
                    <thead>
                        <tr>
                            <th>Option</th>
                            <th>Month #</th>
                            <th>Month</th>
                            <th>Year</th>
                            <th>Total Payment</th>
                            <th>Interest Paid</th>
                            <th>Principal Paid</th>
                            <th>Remaining Balance</th>
                            <th>Total Paid</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dynamic content goes here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        document.getElementById("start-date").valueAsDate = new Date();
        let paymentOptionCounter = 0;

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function getWords(monthCount) {
            function getPlural(number, word) {
                return number === 1 && word.one || word.other;
            }
            var months = { one: 'month', other: 'months' },
                years = { one: 'year', other: 'years' },
                m = monthCount % 12,
                y = Math.floor(monthCount / 12),
                result = [];
            y && result.push(y + ' ' + getPlural(y, years));
            m && result.push(m + ' ' + getPlural(m, months));
            return result.join(' and ');
        }

        function addPaymentOption() {
            paymentOptionCounter++;
            const container = document.getElementById('payment-options-container');
            
            const optionDiv = document.createElement('div');
            optionDiv.className = 'payment-option active';
            optionDiv.id = `payment-option-${paymentOptionCounter}`;
            
            optionDiv.innerHTML = `
                <div class="payment-option-header">
                    <div class="payment-option-title">
                        <h4>ðŸ’° Payment Option ${paymentOptionCounter}</h4>
                        <div class="option-toggle active" onclick="toggleOption(${paymentOptionCounter})"></div>
                    </div>
                    ${paymentOptionCounter > 1 ? `<button class="remove-option-btn" onclick="removePaymentOption(${paymentOptionCounter})">Remove</button>` : ''}
                </div>
                <div class="payment-grid">
                    <div class="input-group">
                        <label for="monthly-payment-${paymentOptionCounter}">Current Monthly Payment (â‚¹)</label>
                        <input type="number" id="monthly-payment-${paymentOptionCounter}" value="35000" min="0" step="100">
                    </div>
                    
                    <div class="input-group">
                        <label for="extra-payment-${paymentOptionCounter}">Extra Monthly Payment (â‚¹)</label>
                        <input type="number" id="extra-payment-${paymentOptionCounter}" value="${paymentOptionCounter === 1 ? '0' : '5000'}" min="0" step="100">
                    </div>
                    
                    <div class="input-group">
                        <label for="yearly-increment-${paymentOptionCounter}">Yearly Extra Payment Increment (â‚¹)</label>
                        <input type="number" id="yearly-increment-${paymentOptionCounter}" value="${paymentOptionCounter === 1 ? '2500' : '5000'}" min="0" step="100">
                    </div>
                    
                    <div class="input-group">
                        <label for="yearly-extra-payment-${paymentOptionCounter}">Yearly Lumpsum Amount (â‚¹)</label>
                        <input type="number" id="yearly-extra-payment-${paymentOptionCounter}" value="${paymentOptionCounter === 1 ? '0' : '50000'}" min="0" step="1000">
                    </div>
                </div>
            `;
            
            container.appendChild(optionDiv);
        }

        function removePaymentOption(optionId) {
            const option = document.getElementById(`payment-option-${optionId}`);
            if (option) {
                option.remove();
            }
        }

        function toggleOption(optionId) {
            const option = document.getElementById(`payment-option-${optionId}`);
            const toggle = option.querySelector('.option-toggle');
            
            if (toggle.classList.contains('active')) {
                toggle.classList.remove('active');
                option.classList.remove('active');
            } else {
                toggle.classList.add('active');
                option.classList.add('active');
            }
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results-section').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('results-section').style.display = 'block';
        }

        function calculateLoanPayoff(loanAmount, annualInterestRate, loanTerm, monthlyPayment, extraPayment, yearlyIncrement, yearlyExtraPayment, startDate) {
            const dailyInterestRate = annualInterestRate / 365;
            let loanBalance = loanAmount;
            let months = 0;
            let totalPaid = 0;
            let currentExtraPayment = extraPayment;
            let currentDate = new Date(startDate);
            let totalInterestPaid = 0;
            let totalPrincipalPaid = 0;
            let paymentSchedule = [];

            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];

            while (loanBalance > 0 && months < 600) { // Safety limit
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const monthName = monthNames[month];

                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const dailyInterest = loanBalance * dailyInterestRate;
                const monthlyInterest = dailyInterest * daysInMonth;

                if (monthName === "January" && months > 0) {
                    currentExtraPayment += yearlyIncrement;
                }

                let totalPayment = monthlyPayment + currentExtraPayment;
                let principalPayment = totalPayment - monthlyInterest;

                if (monthName === "January" && months > 0) {
                    loanBalance -= yearlyExtraPayment;
                    totalPayment += yearlyExtraPayment;
                }

                loanBalance -= principalPayment;
                months++;

                if (loanBalance < 0) {
                    totalPayment += loanBalance;
                    principalPayment += loanBalance;
                    loanBalance = 0;
                }

                totalPaid += totalPayment;
                totalPrincipalPaid += principalPayment;
                totalInterestPaid += monthlyInterest;

                paymentSchedule.push({
                    month: months,
                    monthName: monthName,
                    year: year,
                    totalPayment: totalPayment,
                    interestPaid: monthlyInterest,
                    principalPaid: principalPayment,
                    remainingBalance: loanBalance,
                    totalPaid: totalPaid
                });

                currentDate.setMonth(currentDate.getMonth() + 1);
            }

            return {
                months: months,
                totalPaid: totalPaid,
                totalInterestPaid: totalInterestPaid,
                totalPrincipalPaid: totalPrincipalPaid,
                paymentSchedule: paymentSchedule
            };
        }

        function calculate() {
            showLoading();
            
            setTimeout(() => {
                performCalculation();
            }, 500);
        }

        function performCalculation() {
            const parseFloatAbs = (value) => {
                const parsed = parseFloat(value);
                return isNaN(parsed) ? 0 : Math.abs(parsed);
            };

            const parseIntAbs = (value) => {
                const parsed = parseInt(value);
                return isNaN(parsed) ? 0 : Math.abs(parsed);
            };

            const loanAmount = parseFloatAbs(document.getElementById("loan-amount").value);
            const annualInterestRate = parseFloatAbs(document.getElementById("interest-rate").value) / 100;
            const loanTerm = parseIntAbs(document.getElementById("loan-term").value);
            const startDateInput = document.getElementById("start-date").value;
            const startDate = startDateInput ? new Date(startDateInput) : new Date();

            // Validation
            if (loanTerm === 0 || loanAmount === 0) {
                alert("Please ensure loan amount and term are not zero");
                hideLoading();
                return;
            }

            // Get active payment options
            const activeOptions = [];
            const paymentOptions = document.querySelectorAll('.payment-option.active');
            
            paymentOptions.forEach((option, index) => {
                const optionId = option.id.split('-')[2];
                const monthlyPayment = parseFloatAbs(document.getElementById(`monthly-payment-${optionId}`).value);
                const extraPayment = parseFloatAbs(document.getElementById(`extra-payment-${optionId}`).value);
                const yearlyIncrement = parseFloatAbs(document.getElementById(`yearly-increment-${optionId}`).value);
                const yearlyExtraPayment = parseFloatAbs(document.getElementById(`yearly-extra-payment-${optionId}`).value);

                if (monthlyPayment > 0 || extraPayment > 0 || yearlyIncrement > 0 || yearlyExtraPayment > 0) {
                    activeOptions.push({
                        id: optionId,
                        name: `Option ${optionId}`,
                        monthlyPayment: monthlyPayment,
                        extraPayment: extraPayment,
                        yearlyIncrement: yearlyIncrement,
                        yearlyExtraPayment: yearlyExtraPayment
                    });
                }
            });

            if (activeOptions.length === 0) {
                alert("Please ensure at least one payment option is active with valid payment values");
                hideLoading();
                return;
            }

            // Calculate EMI for comparison
            const monthlyEmi = loanAmount * (annualInterestRate/12) * 
                (Math.pow(1 + (annualInterestRate/12), loanTerm) /
                (Math.pow(1 + (annualInterestRate/12), loanTerm) - 1));

            // Calculate results for each option
            const results = [];
            activeOptions.forEach(option => {
                const result = calculateLoanPayoff(
                    loanAmount, 
                    annualInterestRate, 
                    loanTerm, 
                    option.monthlyPayment, 
                    option.extraPayment, 
                    option.yearlyIncrement, 
                    option.yearlyExtraPayment, 
                    startDate
                );
                
                results.push({
                    ...option,
                    ...result,
                    interestSavings: (monthlyEmi * loanTerm) - result.totalPaid
                });
            });

            // Find best option (lowest total paid)
            const bestOption = results.reduce((best, current) => 
                current.totalPaid < best.totalPaid ? current : best
            );

            // Display comparison results
            displayComparisonResults(results, bestOption, monthlyEmi);
            
            // Display detailed table
            displayDetailedTable(results);

            hideLoading();
        }

        function displayComparisonResults(results, bestOption, monthlyEmi) {
            const container = document.getElementById('comparison-container');
            
            let comparisonHTML = '<h3>ðŸ“Š Payment Options Comparison</h3><div class="comparison-grid">';
            
            results.forEach(result => {
                const isBest = result.id === bestOption.id;
                const yearWord = getWords(result.months);
                
                comparisonHTML += `
                    <div class="result-card ${isBest ? 'best-option' : ''}">
                        ${isBest ? '<div class="best-badge">Best Option</div>' : ''}
                        <h4>ðŸ’° ${result.name}</h4>
                        <div class="result-item">
                            <span class="result-label">Payoff Time:</span>
                            <span class="result-value">${result.months} months (${yearWord})</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Monthly Payment:</span>
                            <span class="result-value emi-value">${formatCurrency(result.monthlyPayment)}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Extra Payment:</span>
                            <span class="result-value">${formatCurrency(result.extraPayment)}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Total Interest:</span>
                            <span class="result-value emi-value">${formatCurrency(result.totalInterestPaid)}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Total Amount Paid:</span>
                            <span class="result-value emi-value">${formatCurrency(result.totalPaid)}</span>
                        </div>
                        ${result.interestSavings > 0 ? `
                        <div class="result-item">
                            <span class="result-label">Interest Savings:</span>
                            <span class="result-value savings-value">${formatCurrency(result.interestSavings)}</span>
                        </div>
                        ` : ''}
                    </div>
                `;
            });
            
            comparisonHTML += '</div>';
            container.innerHTML = comparisonHTML;
        }

        function displayDetailedTable(results) {
            const resultTableBody = document.getElementById("resultTable").getElementsByTagName("tbody")[0];
            resultTableBody.innerHTML = "";

            // Combine all payment schedules
            const maxMonths = Math.max(...results.map(r => r.paymentSchedule.length));
            
            for (let month = 0; month < maxMonths; month++) {
                results.forEach(result => {
                    if (month < result.paymentSchedule.length) {
                        const schedule = result.paymentSchedule[month];
                        const row = resultTableBody.insertRow();
                        row.insertCell(0).innerHTML = `<span class="currency">${result.name}</span>`;
                        row.insertCell(1).innerHTML = `<span class="currency">${schedule.month}</span>`;
                        row.insertCell(2).innerText = schedule.monthName;
                        row.insertCell(3).innerText = schedule.year;
                        row.insertCell(4).innerHTML = `<span class="currency">${formatCurrency(schedule.totalPayment)}</span>`;
                        row.insertCell(5).innerHTML = `<span class="currency">${formatCurrency(schedule.interestPaid)}</span>`;
                        row.insertCell(6).innerHTML = `<span class="currency">${formatCurrency(schedule.principalPaid)}</span>`;
                        row.insertCell(7).innerHTML = `<span class="currency">${formatCurrency(schedule.remainingBalance)}</span>`;
                        row.insertCell(8).innerHTML = `<span class="currency">${formatCurrency(schedule.totalPaid)}</span>`;
                    }
                });
            }
        }

        // Add input validation and formatting
        document.addEventListener('DOMContentLoaded', function() {
            // Add first payment option by default
            addPaymentOption();
            
            // Add input validation
            document.addEventListener('input', function(e) {
                if (e.target.type === 'number' && e.target.value < 0) {
                    e.target.value = 0;
                }
            });
        });
    </script>
</body>
</html>